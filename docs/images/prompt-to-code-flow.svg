<svg xmlns="http://www.w3.org/2000/svg" width="1400" height="980" viewBox="0 0 1400 980" role="img" aria-label="Prompt-to-code: a prompt-based pipeline with mixed action types compiles into a per-language pipeline where prompt actions become generated local actions.">
  <defs>
    <style>
      .title { font: 700 28px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; fill: #111827; }
      .subtitle { font: 500 18px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; fill: #6b7280; }
      .heading { font: 700 18px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; fill: #111827; }
      .text { font: 500 16px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; fill: #111827; }
      .muted { fill: #6b7280; }
      .typeLabel { font: 600 18px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; fill: #111827; }
      .chipText { font: 700 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; fill: #111827; }
      .box { stroke-width: 2; }
    </style>

    <marker id="arrow" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto">
      <path d="M0,0 L7,3.5 L0,7 Z" fill="#6b7280"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1400" height="980" fill="#ffffff"/>

  <text x="40" y="70" class="title">Prompt-to-code: mix actions, keep prompts small</text>
  <text x="40" y="113" class="subtitle">Pipelines can be mostly local/remote actions with a few prompt actions; generation turns prompts into language-native code</text>

  <!-- Legend -->
  <rect x="40" y="136" width="24" height="18" rx="7" fill="#dbeafe" stroke="#60a5fa" class="box"/>
  <text x="74" y="152" class="chipText">Local</text>
  <rect x="150" y="136" width="24" height="18" rx="7" fill="#dcfce7" stroke="#34d399" class="box"/>
  <text x="184" y="152" class="chipText">Remote</text>
  <rect x="288" y="136" width="24" height="18" rx="7" fill="#e9d5ff" stroke="#a78bfa" class="box"/>
  <text x="322" y="152" class="chipText">Prompt</text>
  <rect x="436" y="136" width="24" height="18" rx="7" fill="#eef2ff" stroke="#6366f1" class="box"/>
  <text x="470" y="152" class="chipText">Generated local</text>

  <!-- Top: prompt-based pipeline -->
  <rect x="40" y="201" width="1320" height="302" rx="18" fill="#ffffff" stroke="#d1d5db" class="box"/>
  <text x="64" y="246" class="heading">Prompt-based pipeline (source)</text>
  <text x="64" y="281" class="text muted">local + remote + prompt actions (small generation surface area)</text>

  <!-- Top pipeline actions (left → right) -->
  <rect x="90" y="339" width="170" height="75" rx="14" fill="#dbeafe" stroke="#60a5fa" class="box"/>
  <text x="106" y="371" class="text">validate + normalize</text>
  <text x="175" y="442" class="typeLabel" text-anchor="middle">Local Action</text>

  <rect x="335" y="339" width="170" height="75" rx="14" fill="#dcfce7" stroke="#34d399" class="box"/>
  <text x="351" y="371" class="text">enrich (lookup)</text>
  <text x="420" y="442" class="typeLabel" text-anchor="middle">Remote Action</text>

  <rect x="580" y="339" width="170" height="75" rx="14" fill="#e9d5ff" stroke="#a78bfa" class="box"/>
  <text x="596" y="371" class="text">prompt: classify</text>
  <text x="665" y="442" class="typeLabel" text-anchor="middle">Prompt Action</text>

  <rect x="825" y="339" width="170" height="75" rx="14" fill="#dbeafe" stroke="#60a5fa" class="box"/>
  <text x="841" y="371" class="text">apply rules</text>
  <text x="910" y="442" class="typeLabel" text-anchor="middle">Local Action</text>

  <rect x="1070" y="339" width="170" height="75" rx="14" fill="#e9d5ff" stroke="#a78bfa" class="box"/>
  <text x="1086" y="371" class="text">prompt: rewrite</text>
  <text x="1155" y="442" class="typeLabel" text-anchor="middle">Prompt Action</text>

  <!-- Top pipeline arrows -->
  <line x1="260" y1="377" x2="335" y2="377" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>
  <line x1="505" y1="377" x2="580" y2="377" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>
  <line x1="750" y1="377" x2="825" y2="377" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>
  <line x1="995" y1="377" x2="1070" y2="377" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>

  <!-- Code generation (downwards) -->
  <text x="700" y="515" class="heading" text-anchor="middle">code generation</text>
  <line x1="700" y1="540" x2="700" y2="591" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>
  <text x="700" y="613" class="text muted" text-anchor="middle">prompt actions → generated code</text>

  <!-- Bottom: compiled pipeline -->
  <rect x="40" y="628" width="1320" height="302" rx="18" fill="#ffffff" stroke="#d1d5db" class="box"/>
  <text x="64" y="673" class="heading">Compiled pipeline (per language)</text>
  <text x="64" y="708" class="text muted">prompt actions become generated local actions (reviewable + testable)</text>

  <!-- Bottom pipeline actions (left → right) -->
  <rect x="90" y="766" width="170" height="75" rx="14" fill="#dbeafe" stroke="#60a5fa" class="box"/>
  <text x="106" y="798" class="text">validate + normalize</text>
  <text x="175" y="869" class="typeLabel" text-anchor="middle">Local Action</text>

  <rect x="335" y="766" width="170" height="75" rx="14" fill="#dcfce7" stroke="#34d399" class="box"/>
  <text x="351" y="798" class="text">enrich (lookup)</text>
  <text x="420" y="869" class="typeLabel" text-anchor="middle">Remote Action</text>

  <rect x="580" y="766" width="170" height="75" rx="14" fill="#eef2ff" stroke="#6366f1" class="box"/>
  <text x="596" y="798" class="text">generated: classify</text>
  <text x="665" y="869" class="typeLabel" text-anchor="middle">Generated Local Action</text>

  <rect x="825" y="766" width="170" height="75" rx="14" fill="#dbeafe" stroke="#60a5fa" class="box"/>
  <text x="841" y="798" class="text">apply rules</text>
  <text x="910" y="869" class="typeLabel" text-anchor="middle">Local Action</text>

  <rect x="1070" y="766" width="170" height="75" rx="14" fill="#eef2ff" stroke="#6366f1" class="box"/>
  <text x="1086" y="798" class="text">generated: rewrite</text>
  <text x="1155" y="869" class="typeLabel" text-anchor="middle">Generated Local Action</text>

  <!-- Bottom pipeline arrows -->
  <line x1="260" y1="804" x2="335" y2="804" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>
  <line x1="505" y1="804" x2="580" y2="804" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>
  <line x1="750" y1="804" x2="825" y2="804" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>
  <line x1="995" y1="804" x2="1070" y2="804" stroke="#6b7280" stroke-width="2.5" marker-end="url(#arrow)"/>

  <!-- Footnote -->
  <text x="40" y="970" class="text muted">Conceptual view: prompts remain in source pipelines; compiled pipelines reference generated actions per target language.</text>
</svg>
